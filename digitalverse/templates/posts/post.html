{% extends "base.html" %}
{% load staticfiles %}
{% load markdownify %}

{% block content %}

<div class="thread-page">


<div class="row">
  <div class="large-12 small-12 columns">
    <article>

      <!-- Edit -->
      {% if user == post.author or user.is_staff %}
      <a class="edit-post" href="{{post.get_absolute_url}}/edit">
	<i class="fa fa-pencil"></i>
      </a>
      {% endif %}

      <!-- Title -->
      <h1>{{post.title}}</h1>
      <hr/>

      <!-- Body -->
      <div class="post-body">
	{{post.body | markdownify | safe }}
      </div>


      <br/>
      <div class="post-footer hidden">
	<div class="stats">
    	  <span>
	    <i class="fi-arrow-up arrow"></i>
	    {{post.score}}
	  </span>
	  <span>
	    <i class="fi-comment"></i>
	    0 {{post.comments.count}}
	  </span>
	  <span>
	    <i class="fi-eye"></i>
	    {{post.views}}
	  </span>
	  <!-- 
	  <span>
	    <i class="fi-clock"></i>
	    1h 53m ago
	  </span>
	  -->
	</div>

	<div class="buttons">
	  <a class="small button">
	    rayalez
	  </a>
	  <a class="small button">
	    <i class="fi-arrow-up"></i>Upvote
	  </a>
	</div>
	<div class="clearfix"></div>
	  
      </div> <!-- End post footer -->
    </article>

    <!-- Comments -->
    <div class="comments hidden">
      <textarea placeholder="Write reply..."></textarea>
      <a class="button right">
	Submit Reply
      </a>
      <div class="clearfix"></div>    

      <article class="comment">
	<p>
	  Hey, great post! This is my cool reply!
	</p>
	<div class="comment-footer">
	  alexanderwales
	  12
	  <i class="fi-arrow-up arrow"></i>
	</div>
	<div class="clearfix"></div>    
      </article>
    </div> <!-- End .comments -->

  </div> <!-- End 12-columns -->
</div> <!-- End row -->


</div> <!-- End forum-page -->


<script>
  $('textarea').each(function () {
  this.setAttribute('style', 'height:' + (this.scrollHeight) + 'px;overflow-y:hidden;');
}).on('input', function () {
  this.style.height = 'auto';
  this.style.height = (this.scrollHeight) + 'px';
  });
</script>

<script>
$(document).ready(function(){

var links = $('.post-body').find('a').attr('href');

// function convertVideo(html) {
//     var pattern = /(?:http?s?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=)?(.+)/g;

//     if(pattern.test(html)){
//         var replacement = '<iframe width="420" height="345" src="http://www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe>';
//         var html = html.replace(pattern, replacement);
//     }
//     return html;
// }


// function replaceLink(link){
//         var pattern = /(?:http?s?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=)?(.+)/g;

//         if(pattern.test(link)){
//               var replacement = '<iframe width="420" height="345" src="http://www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe>';
//               var embed = link.replace(pattern, replacement);
//         } 

//         return embed;
// }    

// $('.post-body').find("a").each(function() {
//     $(this).click(function(event) {
// 	event.preventDefault();
// 	console.log($(this).attr('href'));
// 	link = 	$(this).attr('href');
// 	$(this).replaceWith(replaceLink(link));
//     });
    
// })
    

    // $('.post-body').html(
	// $(this).html(function(html) {
	//     return convertVideo($(this).html());    
	// });
    
})

</script>  
{% endblock content %}
